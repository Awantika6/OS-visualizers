<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valet OS | Memory Logic Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;800&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #f8fafc; color: #1e293b; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .glass-panel { background: white; border-radius: 24px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .terminal { background: #0f172a; color: #94a3b8; font-size: 11px; border-radius: 16px; padding: 15px; border-left: 4px solid #4f46e5; height: 350px; display: flex; flex-direction: column; }
        .parking-slot { transition: all 0.3s ease; border: 3px dashed #cbd5e1; min-height: 120px; position: relative; cursor: pointer; }
        .slot-filled { border-style: solid; border-color: #4f46e5; background: #f5f3ff; }
        .mission-card { transition: all 0.3s ease; border-top: 6px solid #e2e8f0; padding: 15px; cursor: pointer; }
        .mission-active { border-top-color: #4f46e5 !important; background: #fdfdff; }
        .mission-success { border-top-color: #22c55e !important; background: #f0fdf4 !important; }
        input[type="text"] { width: 70px; background: #f1f5f9; border-radius: 8px; padding: 4px; text-align: center; font-weight: 800; color: #4f46e5; outline: none; border: 1px solid #e2e8f0; }
        .feedback-area { margin-top: 8px; font-size: 10px; line-height: 1.4; border-top: 1px solid #f1f5f9; padding-top: 5px; display: none; font-style: italic; color: #64748b; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8">
        
        <div class="lg:col-span-3 space-y-6">
            <header>
                <h1 class="text-2xl font-800 tracking-tighter uppercase italic">Memory Allocation Techniques  </h1>
            </header>

            <div class="glass-panel p-5 space-y-4">
                <h3 class="text-[10px] font-black text-indigo-600 uppercase tracking-widest">Techniques:</h3>
                <div class="text-[11px] space-y-3 leading-relaxed">
                    <p><b>First Fit:</b> Scans memory from the top and parks in the <b>first</b> hole that fits. Fast and efficient for quick tasks.</p>
                    <p><b>Best Fit:</b> Scans every hole to find the <b>tightest</b> match. Saves larger slots but creates tiny usable gaps.</p>
                    <p><b>Worst Fit:</b> Deliberately picks the <b>largest</b> hole available so the remaining space is still large enough to use.</p>
                </div>
            </div>

            <div class="terminal">
                <h3 class="text-[9px] font-black text-indigo-400 uppercase mb-4 tracking-widest">System Events</h3>
                <div id="log" class="flex-1 mono overflow-y-auto space-y-2 pr-2">
                    <div>> Kernel v6.0 Initialized</div>
                </div>
            </div>
        </div>

        <div class="lg:col-span-9 space-y-8">
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="mission-container"></div>

            <div class="glass-panel p-8">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-xl font-800 italic uppercase">Parking Blueprint</h2>
                    <div class="flex gap-2">
                        <select id="strat" onchange="loadMissions()" class="bg-indigo-50 p-2 rounded-xl font-bold text-indigo-600 text-xs outline-none border border-indigo-100">
                            <option value="first">Mode: First Fit</option>
                            <option value="best">Mode: Best Fit</option>
                            <option value="worst">Mode: Worst Fit</option>
                        </select>
                        <button onclick="compact()" class="bg-indigo-600 text-white px-4 py-2 rounded-xl text-[10px] font-bold uppercase shadow-lg shadow-indigo-100">Compaction (Defrag)</button>
                    </div>
                </div>

                <div class="grid grid-cols-4 gap-4 mb-8" id="lot"></div>

                <div class="p-6 bg-slate-50 rounded-[2rem] border border-slate-100 flex flex-col items-center gap-6">
                    <div class="flex flex-col items-center">
                        <span class="text-[10px] font-black text-slate-400 uppercase mb-2">Selected Task Control</span>
                        <button onclick="startMission()" class="bg-indigo-600 text-white px-10 py-3 rounded-2xl font-800 uppercase text-xs shadow-xl shadow-indigo-100 hover:scale-105 transition">▶ Initiate Mission Sequence</button>
                    </div>

                    <div class="flex gap-4 w-full">
                        <button onclick="allocate(15, 'van')" class="bg-white border-2 border-indigo-100 p-4 rounded-2xl flex-1 hover:border-indigo-500 transition shadow-sm">
                            <span class="block text-[10px] font-black text-slate-400 uppercase">VAN</span>
                            <span class="text-xl font-800 text-indigo-600">15m</span>
                        </button>
                        <button onclick="allocate(25, 'truck')" class="bg-white border-2 border-rose-100 p-4 rounded-2xl flex-1 hover:border-rose-500 transition shadow-sm">
                            <span class="block text-[10px] font-black text-slate-400 uppercase">TRUCK</span>
                            <span class="text-xl font-800 text-rose-600">25m</span>
                        </button>
                        <button onclick="allocate(8, 'bike')" class="bg-white border-2 border-emerald-100 p-4 rounded-2xl flex-1 hover:border-emerald-500 transition shadow-sm">
                            <span class="block text-[10px] font-black text-slate-400 uppercase">BIKE</span>
                            <span class="text-xl font-800 text-emerald-600">8m</span>
                        </button>
                    </div>
                </div>
                
                <div id="inspector-fb" class="mt-4 p-4 bg-slate-900 text-slate-400 rounded-2xl text-[11px] italic hidden">
                    </div>
            </div>
        </div>
    </div>

    <script>
        let slots = [
            { id: 'A', size: 10, free: 10, car: null },
            { id: 'B', size: 50, free: 50, car: null },
            { id: 'C', size: 20, free: 20, car: null },
            { id: 'D', size: 30, free: 30, car: null }
        ];

        let activeMissionId = 0;

        const missionData = {
            first: [
                { id: 0, title: "FF: Fast Track", desc: "Park a 15m Van. Which slot was bypassed first?", ans: "A", fb: "Correct. Slot A (10m) was checked but skipped because it was too small." },
                { id: 1, title: "FF: First Win", desc: "Park an 8m Bike. True or False: It searched past Slot A?", ans: "false", fb: "Correct. First Fit stops the moment it finds a gap that fits." },
                { id: 2, title: "FF: Cluster", desc: "Park 15m and 25m. How many slots remain EMPTY?", ans: "2", fb: "Correct. Only B and D are filled; A and C are left empty." }
            ],
            best: [
                { id: 0, title: "BF: Precision", desc: "Park 15m Van. Which Slot ID is the tightest match?", ans: "C", fb: "Correct. Best Fit chose 20m over 50m to minimize wasted space." },
                { id: 1, title: "BF: Small Hole", desc: "Park 8m Bike. What is the waste in Slot A?", ans: "2", fb: "Correct. This leaves a tiny gap, known as internal fragmentation." },
                { id: 2, title: "BF: Giant Save", desc: "Is Slot B (50m) still free after parking 15m & 8m? (Yes/No)", ans: "yes", fb: "Correct. Best Fit protected the largest block for a future big vehicle." }
            ],
            worst: [
                { id: 0, title: "WF: Large Gap", desc: "Park 15m Van. Which Slot ID did the OS pick?", ans: "B", fb: "Correct. Worst Fit always targets the largest possible hole." },
                { id: 1, title: "WF: Future Proof", desc: "After parking 15m Van, can Slot B still fit a 25m Truck? (Yes/No)", ans: "yes", fb: "Correct. The 35m leftover space is still very useful!" },
                { id: 2, title: "WF: Comparison", desc: "Park 8m Bike. Which Slot ID has the MOST waste?", ans: "B", fb: "Correct. It keeps the leftovers as large as possible." }
            ]
        };

        function loadMissions() {
            const strat = document.getElementById('strat').value;
            const container = document.getElementById('mission-container');
            container.innerHTML = '';
            missionData[strat].forEach((m) => {
                container.innerHTML += `
                    <div id="m${m.id}" class="glass-panel mission-card" onclick="setActive(${m.id})">
                        <h4 class="text-xs font-800 uppercase mb-1 text-slate-700">${m.title}</h4>
                        <p class="text-[10px] text-slate-500 mb-3">${m.desc}</p>
                        <div class="flex gap-2">
                            <input type="text" id="ans${m.id}" placeholder="Ans">
                            <button onclick="verify(${m.id}, '${m.ans}', '${m.fb}')" class="text-[9px] bg-slate-800 text-white px-3 py-1 rounded-lg font-bold uppercase">Verify</button>
                        </div>
                        <div id="fb${m.id}" class="feedback-area"></div>
                    </div>`;
            });
            resetLot();
            setActive(0);
        }

        function setActive(id) {
            activeMissionId = id;
            document.querySelectorAll('.mission-card').forEach(c => c.classList.remove('mission-active'));
            document.getElementById(`m${id}`).classList.add('mission-active');
        }

        function startMission() {
            resetLot();
            writeLog(`Mission Started: ${document.querySelector('.mission-active h4').innerText}`);
        }

        function render() {
            const lot = document.getElementById('lot');
            lot.innerHTML = '';
            slots.forEach((s, i) => {
                const filled = s.car !== null;
                lot.innerHTML += `
                    <div class="parking-slot rounded-3xl p-4 flex flex-col items-center justify-center ${filled ? 'slot-filled' : ''}" onclick="inspectSlot(${i})">
                        <span class="absolute top-2 left-3 text-[9px] font-black text-slate-300 uppercase">Slot ${s.id}</span>
                        <span class="text-lg font-800 ${filled ? 'text-indigo-600' : 'text-slate-400'}">${s.size}m</span>
                        ${filled ? `<div class="text-[9px] font-bold text-slate-500 mt-1 uppercase">${s.car}m Parked</div>` : ''}
                    </div>`;
            });
        }

        function inspectSlot(i) {
            const s = slots[i];
            const fb = document.getElementById('inspector-fb');
            fb.classList.remove('hidden');
            fb.innerHTML = `> SLOT ${s.id} INSPECTION: Capacity ${s.size}m | ${s.car ? 'Occupied by ' + s.car + 'm vehicle. Waste: ' + s.free + 'm.' : 'Currently Empty.'}`;
        }

        function allocate(size, type) {
            const strat = document.getElementById('strat').value;
            let target = -1;
            if (strat === 'first') target = slots.findIndex(s => s.car === null && s.size >= size);
            else if (strat === 'best') {
                let min = Infinity;
                slots.forEach((s, i) => { if (s.car === null && s.size >= size && (s.size - size) < min) { min = s.size - size; target = i; } });
            } else if (strat === 'worst') {
                let max = -1;
                slots.forEach((s, i) => { if (s.car === null && s.size >= size && (s.size - size) > max) { max = s.size - size; target = i; } });
            }

            if (target !== -1) {
                slots[target].car = size;
                slots[target].free = slots[target].size - size;
                writeLog(`Kernel: Allocated ${size}m to Slot ${slots[target].id}`);
                render();
            } else writeLog(`Kernel: No slot available for ${size}m vehicle.`);
        }

        function verify(id, correct, feedback) {
            const val = document.getElementById('ans' + id).value.toLowerCase();
            const fbBox = document.getElementById('fb' + id);
            fbBox.style.display = "block";
            if (val == correct.toLowerCase()) {
                document.getElementById('m' + id).classList.add('mission-success');
                fbBox.innerHTML = `<span class="text-green-600 font-bold">✓ SUCCESS</span>: ${feedback}`;
            } else fbBox.innerHTML = `<span class="text-red-600 font-bold">× INCORRECT</span>: Re-check the slot blueprint.`;
        }

        function writeLog(msg) {
            const l = document.getElementById('log');
            l.innerHTML = `<div>> ${msg}</div>` + l.innerHTML;
        }

        function resetLot() { slots.forEach(s => { s.car = null; s.free = s.size; }); render(); }
        
        function compact() {
            let cars = slots.filter(s => s.car !== null).map(s => s.car);
            slots.forEach((s, i) => {
                if (i < cars.length) { s.car = cars[i]; s.free = s.size - s.car; }
                else { s.car = null; s.free = s.size; }
            });
            writeLog("OS Event: Compaction successful. Memory consolidated.");
            render();
        }

        loadMissions();
    </script>
</body>
</html>